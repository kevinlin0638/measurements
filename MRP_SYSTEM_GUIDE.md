# MRP 物料需求規劃系統使用指南

## 系統概述

MRP (Material Requirements Planning) 物料需求規劃系統是一個完整的生產規劃工具，能夠根據成品需求、庫存狀況、BOM結構和前置時間，自動計算物料需求和生產計劃。

## 主要功能

### 1. 輸入資料管理
- **成品需求**: 設定各期間的成品需求量
- **期初庫存**: 設定系統開始時的庫存數量
- **BOM結構**: 定義成品的組件結構和需求量
- **供應商管理**: 為每個組件指定供應商
- **前置時間**: 設定各組件的採購/生產前置時間

### 2. MRP 模擬計算
- **庫存缺口計算**: 自動計算需求與庫存的差距
- **生產計劃**: 根據缺口計算生產開始時間
- **組件需求**: 根據BOM結構計算各組件需求量
- **訂單時程**: 根據前置時間計算訂單發出時間

### 3. 期間推進模擬
- **逐步模擬**: 可以逐期間推進查看模擬結果
- **即時更新**: 每個期間的結果即時更新
- **組件訂單**: 顯示各期間的組件訂單需求

## 檔案結構

```
tk-data/
├── mrp-system.html          # MRP系統主頁面
├── mrp-system.js           # MRP系統JavaScript核心
├── MRP_SYSTEM_GUIDE.md    # 使用說明文件
└── 其他檔案...
```

## 使用步驟

### 步驟 1: 開啟系統
1. 在瀏覽器中開啟 `mrp-system.html`
2. 系統會顯示三個主要頁面：
   - **輸入資料**: 設定基本參數和BOM結構
   - **MRP 模擬**: 執行模擬和期間推進
   - **模擬結果**: 查看完整的結果表格

### 步驟 2: 設定基本參數
1. 在「輸入資料」頁面設定：
   - **模擬期間數**: 設定要模擬的期間數量（預設10期）
   - **成品名稱**: 設定成品名稱
   - **成品需求**: 輸入各期間的需求量，用逗號分隔
   - **期初庫存**: 設定系統開始時的庫存數量

### 步驟 3: 設定 BOM 結構
1. 點擊「新增組件」按鈕新增組件
2. 為每個組件設定：
   - **組件名稱**: 組件的識別名稱
   - **需求量**: 每個成品需要的組件數量
   - **供應商**: 該組件的供應商
   - **前置時間**: 從訂單到到貨的期間數

### 步驟 4: 執行 MRP 模擬
1. 點擊「執行 MRP 模擬」按鈕
2. 系統會驗證輸入資料
3. 執行 MRP 計算並顯示結果

### 步驟 5: 查看模擬結果
1. 在「MRP 模擬」頁面可以：
   - 查看當前期間的詳細結果
   - 使用「下一期間」按鈕逐步推進
   - 查看各組件的訂單需求

2. 在「模擬結果」頁面可以：
   - 查看完整的 MRP 表格
   - 查看組件訂單明細表

## 範例說明

### 範例資料
- **模擬期間**: 10期
- **成品需求**: 0,0,0,0,4,0,0,0,0,4
- **期初庫存**: 1
- **組件A**: 需求量2個，供應商A，前置時間2期

### 預期結果
根據您提供的範例，系統會產生以下結果：

| 項目 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |
|------|---|---|---|---|---|---|---|---|---|-----|
| 成品需求 | 0 | 0 | 0 | 0 | 4 | 0 | 0 | 0 | 0 | 4 |
| 期初庫存 | 1 | 1 | 1 | 1 | 1 | 0 | 0 | 0 | 0 | 0 |
| 庫存缺口 | 0 | 0 | Null | Null | 3 | Null | Null | Null | Null | 4 |
| 生產開始 | 0 | 0 | 0 | 3 | 0 | 0 | 0 | 0 | 4 | 0 |

## 核心演算法

### MRP 計算邏輯
1. **需求檢查**: 檢查每個期間的成品需求
2. **庫存計算**: 計算當期可用庫存
3. **缺口計算**: 需求 - 庫存 = 缺口
4. **生產計劃**: 如果有缺口，安排生產
5. **組件需求**: 根據BOM計算組件需求量
6. **訂單時程**: 根據前置時間計算訂單發出時間

### 期間推進邏輯
1. **庫存更新**: 上一期的生產完成後加入庫存
2. **需求消耗**: 當期需求消耗庫存
3. **新需求產生**: 檢查是否有新的生產需求
4. **組件訂單**: 根據前置時間發出組件訂單

## 技術特點

### 前端技術
- **HTML5**: 現代化的網頁結構
- **CSS3**: 響應式設計和現代化UI
- **JavaScript ES6+**: 模組化程式設計

### 核心功能
- **物件導向設計**: 使用類別封裝MRP邏輯
- **資料驗證**: 完整的輸入資料驗證
- **錯誤處理**: 友善的錯誤訊息
- **模組化**: 可重用的程式碼結構

### 擴展性
- **Google Apps Script整合**: 可與Google Sheets整合
- **API設計**: 提供完整的API介面
- **資料匯出**: 支援匯出到Google Sheets

## 故障排除

### 常見問題
1. **需求資料長度錯誤**: 確保需求資料的數量等於模擬期間數
2. **組件設定錯誤**: 確保所有組件都有正確的名稱和需求量
3. **前置時間設定**: 前置時間不能為負數
4. **期初庫存**: 期初庫存不能為負數

### 錯誤訊息
- **驗證失敗**: 檢查輸入資料的格式和數值
- **模擬錯誤**: 檢查是否有遺漏的必要資料
- **期間錯誤**: 確保期間編號在有效範圍內

## 進階功能

### Google Sheets 整合
系統支援將結果匯出到 Google Sheets：
1. 執行 MRP 模擬
2. 點擊「匯出到 Google Sheets」
3. 資料會自動格式化並準備匯出

### 自訂擴展
系統採用模組化設計，可以輕鬆擴展：
- 新增更多成品類型
- 自訂計算邏輯
- 整合其他系統

## 聯絡支援

如有任何問題或建議，請參考：
- 系統文件: `MRP_SYSTEM_GUIDE.md`
- 程式碼註解: 查看 `mrp-system.js` 中的詳細註解
- 範例檔案: 參考現有的範例資料

---

**版本**: 1.0  
**更新日期**: 2024年  
**開發者**: MRP System Team 